{"name":"wave-background","type":"registry:ui","dependencies":["simplex-noise"],"registryDependencies":[],"files":[{"path":"/components/ui/wave-background.tsx","content":"'use client'\nimport * as React from 'react'\nimport { useEffect, useRef } from 'react'\nimport { createNoise2D } from 'simplex-noise'\n\ninterface Point {\n    x: number\n    y: number\n    wave: { x: number; y: number }\n    cursor: {\n        x: number\n        y: number\n        vx: number\n        vy: number\n    }\n}\n\ninterface WavesProps {\n    className?: string\n    strokeColor?: string\n    backgroundColor?: string\n    pointerSize?: number\n}\n\nexport function Waves({\n    className = \"\",\n    strokeColor = \"#ffffff\",  // White lines\n    backgroundColor = \"#000000\",  // Black background\n    pointerSize = 0.5\n}: WavesProps) {\n    const containerRef = useRef<HTMLDivElement>(null)\n    const svgRef = useRef<SVGSVGElement>(null)\n    const mouseRef = useRef({\n        x: -10,\n        y: 0,\n        lx: 0,\n        ly: 0,\n        sx: 0,\n        sy: 0,\n        v: 0,\n        vs: 0,\n        a: 0,\n        set: false,\n    })\n    const pathsRef = useRef<SVGPathElement[]>([])\n    const linesRef = useRef<Point[][]>([])  // 替换any为Point[][]\n    const noiseRef = useRef<((x: number, y: number) => number) | null>(null)  // 替换any为具体的函数类型\n    const rafRef = useRef<number | null>(null)\n    const boundingRef = useRef<DOMRect | null>(null)\n\n    // Initialization\n    useEffect(() => {\n        if (!containerRef.current || !svgRef.current) return\n\n        // Initialize noise generator\n        noiseRef.current = createNoise2D()\n\n        // Initialize size and lines\n        setSize()\n        setLines()\n\n        // Bind events\n        window.addEventListener('resize', onResize)\n        window.addEventListener('mousemove', onMouseMove)\n        containerRef.current.addEventListener('touchmove', onTouchMove, { passive: false })\n\n        // Start animation\n        rafRef.current = requestAnimationFrame(tick)\n\n        return () => {\n            if (rafRef.current) cancelAnimationFrame(rafRef.current)\n            window.removeEventListener('resize', onResize)\n            window.removeEventListener('mousemove', onMouseMove)\n            containerRef.current?.removeEventListener('touchmove', onTouchMove)\n        }\n    }, [])\n\n    // Set SVG size\n    const setSize = () => {\n        if (!containerRef.current || !svgRef.current) return\n\n        boundingRef.current = containerRef.current.getBoundingClientRect()\n        const { width, height } = boundingRef.current\n\n        svgRef.current.style.width = `${width}px`\n        svgRef.current.style.height = `${height}px`\n    }\n\n    // Setup lines - more points for smoother curves\n    const setLines = () => {\n        if (!svgRef.current || !boundingRef.current) return\n\n        const { width, height } = boundingRef.current\n        linesRef.current = []\n\n        // Clear existing paths\n        pathsRef.current.forEach(path => {\n            path.remove()\n        })\n        pathsRef.current = []\n\n        // Use smaller spacing to generate more lines and points for smoother results\n        const xGap = 8  // Reduced horizontal spacing\n        const yGap = 8  // Reduced vertical spacing for denser points\n\n        const oWidth = width + 200\n        const oHeight = height + 30\n\n        const totalLines = Math.ceil(oWidth / xGap)\n        const totalPoints = Math.ceil(oHeight / yGap)\n\n        const xStart = (width - xGap * totalLines) / 2\n        const yStart = (height - yGap * totalPoints) / 2\n\n        // Create vertical lines\n        for (let i = 0; i < totalLines; i++) {\n            const points: Point[] = []\n\n            for (let j = 0; j < totalPoints; j++) {\n                const point: Point = {\n                    x: xStart + xGap * i,\n                    y: yStart + yGap * j,\n                    wave: { x: 0, y: 0 },\n                    cursor: { x: 0, y: 0, vx: 0, vy: 0 },\n                }\n\n                points.push(point)\n            }\n\n            // Create SVG path\n            const path = document.createElementNS(\n                'http://www.w3.org/2000/svg',\n                'path'\n            )\n            path.classList.add('a__line')\n            path.classList.add('js-line')\n            path.setAttribute('fill', 'none')\n            path.setAttribute('stroke', strokeColor)\n            path.setAttribute('stroke-width', '1')\n\n            svgRef.current.appendChild(path)\n            pathsRef.current.push(path)\n\n            // Add points\n            linesRef.current.push(points)\n        }\n    }\n\n    // Resize handler\n    const onResize = () => {\n        setSize()\n        setLines()\n    }\n\n    // Mouse handler\n    const onMouseMove = (e: MouseEvent) => {\n        updateMousePosition(e.pageX, e.pageY)\n    }\n\n    // Touch handler\n    const onTouchMove = (e: TouchEvent) => {\n        e.preventDefault()\n        const touch = e.touches[0]\n        updateMousePosition(touch.clientX, touch.clientY)\n    }\n\n    // Update mouse position\n    const updateMousePosition = (x: number, y: number) => {\n        if (!boundingRef.current) return\n\n        const mouse = mouseRef.current\n        mouse.x = x - boundingRef.current.left\n        mouse.y = y - boundingRef.current.top + window.scrollY\n\n        if (!mouse.set) {\n            mouse.sx = mouse.x\n            mouse.sy = mouse.y\n            mouse.lx = mouse.x\n            mouse.ly = mouse.y\n\n            mouse.set = true\n        }\n\n        // Update CSS variables\n        if (containerRef.current) {\n            containerRef.current.style.setProperty('--x', `${mouse.sx}px`)\n            containerRef.current.style.setProperty('--y', `${mouse.sy}px`)\n        }\n    }\n\n    // Move points - smoother wave motion\n    const movePoints = (time: number) => {\n        const { current: lines } = linesRef\n        const { current: mouse } = mouseRef\n        const { current: noise } = noiseRef\n\n        if (!noise) return\n\n        lines.forEach((points) => {\n            points.forEach((p: Point) => {\n                // Wave movement - reduced amplitude for smoother waves\n                const move = noise(\n                    (p.x + time * 0.008) * 0.003,  // Adjusted frequency\n                    (p.y + time * 0.003) * 0.002   // Adjusted frequency\n                ) * 8  // Reduced amplitude for smoother waves\n\n                p.wave.x = Math.cos(move) * 12  // Reduced horizontal amplitude\n                p.wave.y = Math.sin(move) * 6   // Reduced vertical amplitude\n\n                // Mouse effect - smoother response\n                const dx = p.x - mouse.sx\n                const dy = p.y - mouse.sy\n                const d = Math.hypot(dx, dy)\n                const l = Math.max(175, mouse.vs)\n\n                if (d < l) {\n                    const s = 1 - d / l\n                    const f = Math.cos(d * 0.001) * s\n\n                    p.cursor.vx += Math.cos(mouse.a) * f * l * mouse.vs * 0.00035  // Reduced influence\n                    p.cursor.vy += Math.sin(mouse.a) * f * l * mouse.vs * 0.00035  // Reduced influence\n                }\n\n                p.cursor.vx += (0 - p.cursor.x) * 0.01   // Increased restoration force\n                p.cursor.vy += (0 - p.cursor.y) * 0.01   // Increased restoration force\n\n                p.cursor.vx *= 0.95  // Increased smoothness\n                p.cursor.vy *= 0.95  // Increased smoothness\n\n                p.cursor.x += p.cursor.vx\n                p.cursor.y += p.cursor.vy\n\n                p.cursor.x = Math.min(50, Math.max(-50, p.cursor.x))  // Limited deformation range\n                p.cursor.y = Math.min(50, Math.max(-50, p.cursor.y))  // Limited deformation range\n            })\n        })\n    }\n\n    // Get moved point coordinates\n    const moved = (point: Point, withCursorForce = true) => {\n        const coords = {\n            x: point.x + point.wave.x + (withCursorForce ? point.cursor.x : 0),\n            y: point.y + point.wave.y + (withCursorForce ? point.cursor.y : 0),\n        }\n\n        return coords\n    }\n\n    // Draw lines - using line segments\n    const drawLines = () => {\n        const { current: lines } = linesRef\n        const { current: paths } = pathsRef\n\n        lines.forEach((points, lIndex) => {\n            if (points.length < 2 || !paths[lIndex]) return;\n\n            // First point\n            const firstPoint = moved(points[0], false)\n            let d = `M ${firstPoint.x} ${firstPoint.y}`\n\n            // Connect points with lines\n            for (let i = 1; i < points.length; i++) {\n                const current = moved(points[i])\n                d += `L ${current.x} ${current.y}`\n            }\n\n            paths[lIndex].setAttribute('d', d)\n        })\n    }\n\n    // Animation logic\n    const tick = (time: number) => {\n        const { current: mouse } = mouseRef\n\n        // Smooth mouse movement\n        mouse.sx += (mouse.x - mouse.sx) * 0.1\n        mouse.sy += (mouse.y - mouse.sy) * 0.1\n\n        // Mouse velocity\n        const dx = mouse.x - mouse.lx\n        const dy = mouse.y - mouse.ly\n        const d = Math.hypot(dx, dy)\n\n        mouse.v = d\n        mouse.vs += (d - mouse.vs) * 0.1\n        mouse.vs = Math.min(100, mouse.vs)\n\n        // Previous mouse position\n        mouse.lx = mouse.x\n        mouse.ly = mouse.y\n\n        // Mouse angle\n        mouse.a = Math.atan2(dy, dx)\n\n        // Animation\n        if (containerRef.current) {\n            containerRef.current.style.setProperty('--x', `${mouse.sx}px`)\n            containerRef.current.style.setProperty('--y', `${mouse.sy}px`)\n        }\n\n        movePoints(time)\n        drawLines()\n\n        rafRef.current = requestAnimationFrame(tick)\n    }\n\n    return (\n        <div\n            ref={containerRef}\n            className={`waves-component relative overflow-hidden ${className}`}\n            style={{\n                backgroundColor,\n                position: 'absolute',\n                top: 0,\n                left: 0,\n                margin: 0,\n                padding: 0,\n                width: '100%',\n                height: '100%',\n                overflow: 'hidden',\n                '--x': '-0.5rem',\n                '--y': '50%',\n            } as React.CSSProperties}\n        >\n            <svg\n                ref={svgRef}\n                className=\"block w-full h-full js-svg\"\n                xmlns=\"http://www.w3.org/2000/svg\"\n            />\n            <div\n                className=\"pointer-dot\"\n                style={{\n                    position: 'absolute',\n                    top: 0,\n                    left: 0,\n                    width: `${pointerSize}rem`,\n                    height: `${pointerSize}rem`,\n                    background: strokeColor,\n                    borderRadius: '50%',\n                    transform: 'translate3d(calc(var(--x) - 50%), calc(var(--y) - 50%), 0)',\n                    willChange: 'transform',\n                }}\n            />\n        </div>\n    )\n}","type":"registry:ui","target":""}],"tailwind":{"config":{}}}